name = "givc-ultrathink"
main = "workers/router.js"
compatibility_date = "2024-11-05"

# Pages configuration - Use root directory for static HTML site
pages_build_output_dir = "."

# If you want to build the frontend subdirectory instead, use:
# pages_build_output_dir = "dist"
# pages_build_command = "npm run build"

# Environment variables for Pages
[vars]
ENVIRONMENT = "production"
HIPAA_COMPLIANCE_LEVEL = "strict"
RCM_ACCREDITATION = "enabled"

# Ultrathink AI Configuration
ULTRATHINK_ENABLED = "true"
AI_VALIDATION_ENABLED = "true"
SMART_COMPLETION_ENABLED = "true"
ERROR_PREDICTION_ENABLED = "true"
ANOMALY_DETECTION_ENABLED = "true"

# FastAPI Backend URL (Deploy FastAPI separately)
API_BACKEND_URL = "" # Set to your FastAPI deployment URL
FASTAPI_PORT = "8000"

# Security Settings
SECURITY_MIDDLEWARE_ENABLED = "true"
RATE_LIMIT_DEFAULT = "100"
RATE_LIMIT_STRICT = "10"

# D1 Database Bindings
[[d1_databases]]
binding = "DB"
database_name = "givc-healthcare-prod"
database_id = "" # Will be set during deployment

[[d1_databases]]
binding = "HEALTHCARE_DB"
database_name = "givc-healthcare-prod"
database_id = "" # Will be set during deployment

# KV Namespace Bindings
[[kv_namespaces]]
binding = "MEDICAL_METADATA"
id = "" # Will be set during deployment

[[kv_namespaces]]
binding = "AUDIT_LOGS"
id = "" # Will be set during deployment

# R2 Bucket Bindings
[[r2_buckets]]
binding = "MEDICAL_FILES"
bucket_name = "givc-medical-files"

# Secrets (Set via GitHub Actions or wrangler secret put)
# Required secrets:
# - JWT_SECRET: Secret key for JWT signing
# - ENCRYPTION_KEY: Master encryption key for AES-256-GCM
# - CLOUDFLARE_API_TOKEN: API token for Cloudflare access
# - CLOUDFLARE_ACCOUNT_ID: Account ID
# - API_SECRET_KEY: Ultrathink API secret key
# - DATABASE_URL: PostgreSQL connection string for Ultrathink
# - REDIS_URL: Redis connection string for caching (optional)

# Workers AI Binding
[ai]
binding = "AI"

# Queue Binding (for async processing)
[[queues.producers]]
binding = "PROCESSING_QUEUE"
queue = "medical-processing-queue"

# Durable Objects (for rate limiting)
[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "RateLimiter"
script_name = "givc"

# Limits and Resources
[limits]
cpu_ms = 50


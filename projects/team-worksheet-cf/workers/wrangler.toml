name = "team-worksheet-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"
node_compat = true

# Workers AI for smart features
[ai]
binding = "AI"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "team-worksheet-db"
database_id = "" # Add your database ID after: wrangler d1 create team-worksheet-db
migrations_dir = "migrations"

# R2 Storage for files
[[r2_buckets]]
binding = "BUCKET"
bucket_name = "team-worksheet-files"

# KV for caching and sessions
[[kv_namespaces]]
binding = "KV"
id = "" # Add your KV namespace ID after: wrangler kv:namespace create "team_worksheet_cache"

# Durable Objects for real-time collaboration
[[durable_objects.bindings]]
name = "WORKSHEET_ROOM"
class_name = "WorksheetRoom"
script_name = "team-worksheet-api"

[[migrations]]
tag = "v1"
new_classes = ["WorksheetRoom"]

# Environment variables (use .dev.vars for local development)
[vars]
ENVIRONMENT = "production"
JWT_EXPIRES_IN = "7d"
MAX_FILE_SIZE = "10485760" # 10MB
CORS_ORIGINS = "https://worksheet.brainsait.io"

# Development configuration
[env.development]
[env.development.vars]
ENVIRONMENT = "development"
CORS_ORIGINS = "*"

# Staging configuration
[env.staging]
[env.staging.vars]
ENVIRONMENT = "staging"
CORS_ORIGINS = "https://staging-worksheet.brainsait.io"

# Limits and scaling
[limits]
cpu_ms = 50 # Max CPU time per request (50ms)

# Analytics and monitoring
[observability]
enabled = true
